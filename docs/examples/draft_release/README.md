# Github release drafter

Drafts new release including changelog, new tag. Best used on merge/push to main
branch. Best used in combination with `check_if_version_is_incremented` workflow
to detect source changes and get the newest version.

Uses `${{ github.sha }}` internally to specify the target for the new tag.

```yml
name: Merge to main
on:
  push:
    branches:
      - main

jobs:
  get_version:
    name: "Get package.json version"
    uses: whereby/github-actions/.github/workflows/check_if_version_is_incremented.yml@1.0.0
    with:
      source_dir: src
  draft_release:
    if: needs.get_version.outputs.new_version
    needs: get_version
    name: "Draft release"
    uses: whereby/github-actions/.github/workflows/draft_release.yml@1.0.0
    with:
      tag_name: "${{ needs.get_version.outputs.new_version }}"
```

## Inputs

`tag_name`: required, the tag name to create and point to the most recent commit

## Outputs

A release draft which can be found in the Github web interface by visiting
https://github.com/whereby/${REPO}/releases

**Gotchas**
In the consuming repo, the file `.github/release-drafter.yml` needs to exist
with eg the following template

```yml
template: |
  ## What's Changed

  $CHANGES
```

Ideally this would be automatically generated by this workflow, but is currently
not supported by Release Drafter dependency. Check out
https://github.com/marketplace/actions/release-drafter to learn how to customize
the template.
